plugins {
    id 'org.jetbrains.kotlin.multiplatform'
    id 'org.jetbrains.dokka'
}

kotlin {
    jvm()
    targets {
        final def ios = System.getenv('SDK_NAME')?.startsWith("iphoneos") ? presets.iosArm64 : presets.iosX64
        fromPreset(ios, 'ios')
    }

    sourceSets {
        commonMain{
            dependencies {
                implementation libraries.okio
                implementation libraries.coroutinesCore
                implementation libraries.dateTime
                implementation project(path: ':cache')
            }
        }

        commonTest {
            dependencies {
                implementation (libraries.kotlinTestJunit)
                implementation (libraries.coroutinesTest)
            }
        }
        jvmMain {
            dependsOn(commonMain)
        }

        jvmTest{
            dependencies{
                implementation ("org.jetbrains.kotlinx:lincheck:2.14.1")
            }
        }

        ios{
            dependsOn(commonMain)
        }
    }
}

//apply from: rootProject.file("gradle/jacoco.gradle")

apply plugin: 'com.vanniktech.maven.publish'